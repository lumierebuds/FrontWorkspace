<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>07_jquery_api</title>
    <script src="https://code.jquery.com/jquery-latest.js"></script>
  </head>
  <body>
    <h1>jQuery API</h1>
    <h2>$(selector).each</h2>
    <ul id="animals">
      <li>dog</li>
      <li>cat</li>
      <li>warmbat</li>
    </ul>
    <input type="button" value="실행" onclick="test1()" />
    <script>
      // each : jquery객체의 요소를 순회하는 메서드
      function test1() {
        var $animals = $("#animals").children();

        $animals.each(function (index, li) {
          var $li = $(li);
          var a = $li.text(); // dog, cat, warmbat
          var A = a.toUpperCase(); // DOG, CAT, WARMBAT
          $li.text(A);
        });
      }
    </script>

    <h2>$.each</h2>
    <input type="button" value="실행" onclick="test2()" />
    <script>
      /*
            $.each((js|jq)배열, jq배열, 객체, function(){})
            - 배열 : callback(index, 요소)
            - 객체 : callback(key, value)
            (들어가는 매개인자의 타입에 따라서 다름)

        */
      function test2() {
        // 배열을 each
        var arr = [1, 2, 3, 4, 5];
        $.each(arr, function (index, value) {
          console.log(index + " : " + value);
        });

        // 객체를 each
        var obj = {
          name: "홍길동",
          age: 34,
        };
        $.each(obj, function (key, value) {
          console.log(key + " : " + value);
        });
      }
    </script>

    <h2>data</h2>
    <input type="button" value="실행" onclick="test3();" />
    <ul id="pets">
      <li data-birth-day="20030503" data-breed="푸들" data-weight="3.5">
        구리구리
      </li>
      <li data-birth-day="20000101" data-breed="요크셔테리어" data-weight="3">
        까미
      </li>
      <li data-birth-day="20051203" data-breed="코카스패니엘" data-weight="13">
        사랑이
      </li>
    </ul>

    <script>
      /* 
            element는 dataset에 저장된 데이터를 get/set할 수 있음
        */
      function test3() {
        var colors = ["흰", "검은", "브라운"];

        var $pets = $("#pets").children();

        $pets.each(function (i, li) {
          // getter
          console.log(li.dataset); // js DOMStringMap
          console.log($(li).data()); // Object
          console.log($(li).data().birthDay);
          // 키값에 하이픈이 들어가면 뒤에 있는 단어를 "대문자로 변경"(카멜표기법)
          // js에서 하이픈은 빼기 연산자에 해당해서
          console.log($(li).data("birthDay"));

          // setter
          // li[i].dataset.petColor = colors[i];
          $(li).data("petColor", colors[i]);
          // 위의 두 코드는 현재 html요소에 속성을 추가하지 않는다.
          $(li).attr("data-pet-color", colors[i]);
          console.log(li.dataset);
          console.log($(li).data());
        });
      }
    </script>

    <h2>is(selector)</h2>
    <input type="button" value="실행" onclick="test4()" />

    <div class="wrapper">
      <h2>h2</h2>
      <h3 class="test">h3</h3>
      <p class="test">p</p>
      <pre>pre</pre>
    </div>

    <script>
      // is(selector) 현재 jquery 객체가 selector와 일치하는지를 판단하는 함수
      function test4() {
        var $children = $(".wrapper").children(); // [h2, h3, p, pre]
        $.each($children, function (i, elem) {
          //   console.log($(elem).is(".test"));
          var $elem = $(elem);
          if ($elem.is("p")) {
            $elem.css("color", "red");
          }
          if ($elem.is(".test")) {
            $elem.css("background", "springgreen");
          }
        });
      }
    </script>
    <br /><br /><br /><br /><br /><br /><br /><br /><br />
  </body>
</html>
